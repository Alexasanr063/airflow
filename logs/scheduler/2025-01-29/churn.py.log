[2025-01-29T14:55:00.570+0000] {processor.py:186} INFO - Started process (PID=126) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:55:00.571+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:55:00.574+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:00.574+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:55:00.596+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:00.596+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:55:00.597+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:00.597+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:55:00.600+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:00.600+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:55:01.101+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:01.101+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:55:01.306+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:01.299+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:55:01.307+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:55:01.316+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.751 seconds
[2025-01-29T14:55:32.291+0000] {processor.py:186} INFO - Started process (PID=192) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:55:32.292+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:55:32.294+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:32.294+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:55:32.316+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:32.316+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:55:32.317+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:32.317+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:55:32.320+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:32.320+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:55:32.794+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:32.794+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:55:32.999+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:55:32.994+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:55:33.000+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:55:33.015+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.730 seconds
[2025-01-29T14:56:03.434+0000] {processor.py:186} INFO - Started process (PID=258) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:56:03.435+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:56:03.438+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:03.437+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:56:03.461+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:03.461+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:56:03.462+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:03.461+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:56:03.464+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:03.464+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:56:03.969+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:03.968+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:56:04.140+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:04.133+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:56:04.141+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:56:04.160+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.732 seconds
[2025-01-29T14:56:34.721+0000] {processor.py:186} INFO - Started process (PID=324) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:56:34.722+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:56:34.725+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:34.724+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:56:34.746+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:34.746+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:56:34.746+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:34.746+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:56:34.748+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:34.748+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:56:35.245+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:35.245+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:56:35.399+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:56:35.393+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:56:35.400+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:56:35.417+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.701 seconds
[2025-01-29T14:57:06.344+0000] {processor.py:186} INFO - Started process (PID=390) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:57:06.345+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:57:06.347+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:06.347+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:57:06.369+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:06.369+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:57:06.370+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:06.370+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:57:06.373+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:06.373+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:57:06.889+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:06.889+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:57:07.080+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:07.074+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:57:07.081+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:57:07.097+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.759 seconds
[2025-01-29T14:57:37.492+0000] {processor.py:186} INFO - Started process (PID=456) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:57:37.493+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:57:37.496+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:37.495+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:57:37.517+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:37.516+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:57:37.517+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:37.517+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:57:37.520+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:37.520+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:57:38.082+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:38.081+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:57:38.242+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:57:38.236+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:57:38.243+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:57:38.253+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.766 seconds
[2025-01-29T14:58:08.898+0000] {processor.py:186} INFO - Started process (PID=522) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:58:08.899+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:58:08.901+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:08.901+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:58:08.929+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:08.929+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:58:08.930+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:08.930+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:58:08.933+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:08.932+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:58:09.435+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:09.435+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:58:09.636+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:09.631+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:58:09.637+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:58:09.652+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.760 seconds
[2025-01-29T14:58:40.485+0000] {processor.py:186} INFO - Started process (PID=588) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:58:40.486+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:58:40.489+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:40.489+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:58:40.510+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:40.510+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:58:40.511+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:40.511+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:58:40.513+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:40.513+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:58:41.014+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:41.014+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:58:41.186+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:58:41.180+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:58:41.187+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:58:41.197+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.717 seconds
[2025-01-29T14:59:11.642+0000] {processor.py:186} INFO - Started process (PID=654) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:59:11.642+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:59:11.645+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:11.644+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:59:11.666+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:11.666+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:59:11.667+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:11.667+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:59:11.669+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:11.669+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:59:12.181+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:12.181+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:59:12.331+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:12.325+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:59:12.332+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:59:12.344+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.707 seconds
[2025-01-29T14:59:42.888+0000] {processor.py:186} INFO - Started process (PID=720) to work on /opt/airflow/dags/churn.py
[2025-01-29T14:59:42.889+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T14:59:42.891+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:42.891+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T14:59:42.911+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:42.911+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:59:42.912+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:42.912+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T14:59:42.914+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:42.913+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T14:59:43.442+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:43.442+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T14:59:43.640+0000] {logging_mixin.py:190} INFO - [2025-01-29T14:59:43.633+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T14:59:43.640+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T14:59:43.656+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.773 seconds
[2025-01-29T15:00:14.120+0000] {processor.py:186} INFO - Started process (PID=786) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:00:14.121+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:00:14.123+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:14.123+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:00:14.143+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:14.143+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:00:14.144+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:14.144+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:00:14.146+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:14.146+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:00:14.656+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:14.656+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:00:14.804+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:14.798+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:00:14.805+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:00:14.813+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.698 seconds
[2025-01-29T15:00:45.166+0000] {processor.py:186} INFO - Started process (PID=852) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:00:45.167+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:00:45.170+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:45.170+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:00:45.190+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:45.190+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:00:45.191+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:45.190+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:00:45.193+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:45.192+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:00:45.717+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:45.717+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:00:45.879+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:00:45.871+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:00:45.880+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:00:45.890+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.729 seconds
[2025-01-29T15:01:16.468+0000] {processor.py:186} INFO - Started process (PID=918) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:01:16.469+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:01:16.471+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:16.471+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:01:16.490+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:16.490+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:01:16.491+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:16.491+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:01:16.493+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:16.493+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:01:17.010+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:17.009+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:01:17.162+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:17.157+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:01:17.163+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:01:17.171+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.708 seconds
[2025-01-29T15:01:47.492+0000] {processor.py:186} INFO - Started process (PID=984) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:01:47.493+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:01:47.495+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:47.495+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:01:47.515+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:47.515+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:01:47.516+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:47.516+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:01:47.518+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:47.518+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:01:47.984+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:47.984+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:01:48.138+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:01:48.132+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:01:48.139+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:01:48.154+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.668 seconds
[2025-01-29T15:02:18.991+0000] {processor.py:186} INFO - Started process (PID=1050) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:02:18.992+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:02:18.995+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:18.995+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:02:19.018+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:19.017+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:02:19.018+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:19.018+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:02:19.020+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:19.020+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:02:19.545+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:19.544+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:02:19.720+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:19.712+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:02:19.720+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:02:19.737+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.752 seconds
[2025-01-29T15:02:50.244+0000] {processor.py:186} INFO - Started process (PID=1116) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:02:50.245+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:02:50.248+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:50.247+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:02:50.267+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:50.267+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:02:50.268+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:50.268+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:02:50.270+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:50.269+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:02:50.768+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:50.767+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:02:50.939+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:02:50.933+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:02:50.939+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:02:50.955+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.716 seconds
[2025-01-29T15:03:21.642+0000] {processor.py:186} INFO - Started process (PID=1182) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:03:21.642+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:03:21.645+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:21.645+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:03:21.664+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:21.664+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:03:21.665+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:21.665+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:03:21.667+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:21.667+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:03:22.149+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:22.149+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:03:22.333+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:22.327+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:03:22.334+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:03:22.349+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.713 seconds
[2025-01-29T15:03:52.832+0000] {processor.py:186} INFO - Started process (PID=1248) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:03:52.833+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:03:52.835+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:52.835+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:03:52.855+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:52.854+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:03:52.855+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:52.855+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:03:52.857+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:52.857+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:03:53.355+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:53.354+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:03:53.501+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:03:53.495+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:03:53.502+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:03:53.517+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.690 seconds
[2025-01-29T15:04:24.233+0000] {processor.py:186} INFO - Started process (PID=1314) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:04:24.234+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:04:24.236+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:24.236+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:04:24.257+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:24.257+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:04:24.258+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:24.258+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:04:24.260+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:24.260+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:04:25.743+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:25.743+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:04:25.930+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:25.923+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:04:25.931+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:04:25.946+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 1.719 seconds
[2025-01-29T15:04:56.618+0000] {processor.py:186} INFO - Started process (PID=1380) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:04:56.619+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:04:56.621+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:56.621+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:04:56.643+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:56.643+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:04:56.644+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:56.644+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:04:56.646+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:56.646+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:04:57.166+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:57.166+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:04:57.319+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:04:57.313+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:04:57.320+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:04:57.337+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.724 seconds
[2025-01-29T15:05:27.910+0000] {processor.py:186} INFO - Started process (PID=1453) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:05:27.911+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:05:27.914+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:27.913+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:05:27.933+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:27.932+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:05:27.933+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:27.933+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:05:27.935+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:27.935+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:05:28.417+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:28.417+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:05:28.571+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:28.565+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:05:28.572+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:05:28.581+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.676 seconds
[2025-01-29T15:05:58.890+0000] {processor.py:186} INFO - Started process (PID=1519) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:05:58.891+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:05:58.893+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:58.893+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:05:58.915+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:58.915+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:05:58.915+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:58.915+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:05:58.917+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:58.917+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:05:59.447+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:59.446+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:05:59.598+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:05:59.591+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:05:59.599+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:05:59.613+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.729 seconds
[2025-01-29T15:06:30.302+0000] {processor.py:186} INFO - Started process (PID=1585) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:06:30.302+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:06:30.305+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:06:30.304+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:06:30.325+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:06:30.325+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:06:30.326+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:06:30.326+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:06:30.328+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:06:30.328+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:06:30.987+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:06:30.987+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:06:31.192+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:06:31.186+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:06:31.193+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:06:31.205+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.908 seconds
[2025-01-29T15:07:01.543+0000] {processor.py:186} INFO - Started process (PID=1651) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:07:01.544+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:07:01.546+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:01.546+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:07:01.566+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:01.566+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:07:01.567+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:01.567+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:07:01.569+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:01.569+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:07:02.054+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:02.054+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:07:02.220+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:02.214+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:07:02.221+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:07:02.237+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.699 seconds
[2025-01-29T15:07:33.206+0000] {processor.py:186} INFO - Started process (PID=1722) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:07:33.207+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:07:33.209+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:33.209+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:07:33.232+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:33.232+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:07:33.233+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:33.233+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:07:33.235+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:33.235+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:07:33.834+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:33.833+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:07:34.031+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:07:34.025+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:07:34.032+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:07:34.047+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.765 seconds
[2025-01-29T15:08:04.143+0000] {processor.py:186} INFO - Started process (PID=1788) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:08:04.143+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:08:04.146+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:04.146+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:08:04.169+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:04.169+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:08:04.170+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:04.170+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:08:04.172+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:04.172+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:08:04.725+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:04.725+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:08:04.880+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:04.873+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:08:04.881+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:08:04.891+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.753 seconds
[2025-01-29T15:08:36.440+0000] {processor.py:186} INFO - Started process (PID=1865) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:08:36.440+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:08:36.443+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:36.443+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:08:36.464+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:36.464+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:08:36.465+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:36.465+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:08:36.467+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:36.467+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:08:36.977+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:36.977+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:08:37.127+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:08:37.122+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:08:37.128+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:08:37.136+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.702 seconds
[2025-01-29T15:09:07.545+0000] {processor.py:186} INFO - Started process (PID=1931) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:09:07.546+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:09:07.548+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:07.548+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:09:07.573+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:07.573+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:09:07.574+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:07.574+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:09:07.577+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:07.577+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:09:08.068+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:08.067+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:09:08.248+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:08.242+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:09:08.249+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:09:08.264+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.724 seconds
[2025-01-29T15:09:38.858+0000] {processor.py:186} INFO - Started process (PID=1998) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:09:38.859+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:09:38.861+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:38.861+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:09:38.883+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:38.883+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:09:38.883+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:38.883+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:09:38.885+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:38.885+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:09:39.381+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:39.381+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:09:39.535+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:09:39.529+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:09:39.536+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:09:39.545+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.695 seconds
[2025-01-29T15:10:10.556+0000] {processor.py:186} INFO - Started process (PID=2067) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:10:10.556+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:10:10.559+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:10.559+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:10:10.579+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:10.579+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:10:10.580+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:10.580+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:10:10.582+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:10.582+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:10:11.060+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:11.059+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:10:11.251+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:11.245+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:10:11.252+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:10:11.268+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.717 seconds
[2025-01-29T15:10:41.630+0000] {processor.py:186} INFO - Started process (PID=2133) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:10:41.631+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:10:41.633+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:41.633+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:10:41.654+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:41.654+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:10:41.655+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:41.655+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:10:41.657+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:41.657+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:10:42.164+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:42.163+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:10:42.338+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:10:42.331+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:10:42.339+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:10:42.355+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.730 seconds
[2025-01-29T15:11:13.657+0000] {processor.py:186} INFO - Started process (PID=2206) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:11:13.657+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:11:13.660+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:13.660+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:11:13.681+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:13.681+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:11:13.682+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:13.682+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:11:13.684+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:13.684+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:11:14.205+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:14.204+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:11:14.414+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:14.409+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:11:14.415+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:11:14.424+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.773 seconds
[2025-01-29T15:11:44.501+0000] {processor.py:186} INFO - Started process (PID=2279) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:11:44.502+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:11:44.504+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:44.504+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:11:44.525+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:44.525+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:11:44.526+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:44.525+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:11:44.528+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:44.527+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:11:45.064+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:45.063+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:11:45.253+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:11:45.237+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:11:45.253+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:11:45.263+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.768 seconds
[2025-01-29T15:12:15.780+0000] {processor.py:186} INFO - Started process (PID=2346) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:12:15.781+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:12:15.783+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:15.783+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:12:15.805+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:15.805+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:12:15.805+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:15.805+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:12:15.807+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:15.807+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:12:16.296+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:16.296+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:12:16.442+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:16.436+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:12:16.443+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:12:16.459+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.683 seconds
[2025-01-29T15:12:47.215+0000] {processor.py:186} INFO - Started process (PID=2417) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:12:47.216+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:12:47.218+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:47.218+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:12:47.239+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:47.239+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:12:47.240+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:47.240+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:12:47.242+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:47.242+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:12:47.724+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:47.724+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:12:47.873+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:12:47.867+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:12:47.874+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:12:47.889+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.680 seconds
[2025-01-29T15:13:18.961+0000] {processor.py:186} INFO - Started process (PID=2491) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:13:18.962+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:13:18.965+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:18.964+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:13:18.985+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:18.985+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:13:18.986+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:18.985+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:13:18.987+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:18.987+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:13:19.492+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:19.492+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:13:19.683+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:19.676+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:13:19.684+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:13:19.693+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.737 seconds
[2025-01-29T15:13:50.193+0000] {processor.py:186} INFO - Started process (PID=2560) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:13:50.194+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:13:50.196+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:50.196+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:13:50.217+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:50.217+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:13:50.218+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:50.218+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:13:50.219+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:50.219+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:13:50.717+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:50.717+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:13:50.880+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:13:50.875+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:13:50.881+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:13:50.890+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.702 seconds
[2025-01-29T15:14:21.700+0000] {processor.py:186} INFO - Started process (PID=2632) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:14:21.701+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:14:21.703+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:21.703+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:14:21.725+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:21.725+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:14:21.725+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:21.725+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:14:21.727+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:21.727+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:14:22.189+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:22.188+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:14:22.325+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:22.319+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:14:22.326+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:14:22.342+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.647 seconds
[2025-01-29T15:14:52.917+0000] {processor.py:186} INFO - Started process (PID=2699) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:14:52.917+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:14:52.920+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:52.920+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:14:52.940+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:52.940+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:14:52.941+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:52.940+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:14:52.943+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:52.942+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:14:53.685+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:53.684+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:14:53.901+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:14:53.895+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:14:53.902+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:14:53.912+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 1.001 seconds
[2025-01-29T15:15:24.391+0000] {processor.py:186} INFO - Started process (PID=2765) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:15:24.392+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:15:24.394+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:24.394+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:15:24.415+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:24.415+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:15:24.416+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:24.416+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:15:24.418+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:24.418+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:15:24.907+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:24.907+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:15:25.069+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:25.062+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:15:25.070+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:15:25.080+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.694 seconds
[2025-01-29T15:15:55.231+0000] {processor.py:186} INFO - Started process (PID=2831) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:15:55.232+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:15:55.234+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:55.234+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:15:55.255+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:55.255+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:15:55.255+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:55.255+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:15:55.257+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:55.257+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:15:55.805+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:55.804+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:15:55.963+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:15:55.957+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:15:55.964+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:15:55.979+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.753 seconds
[2025-01-29T15:16:26.484+0000] {processor.py:186} INFO - Started process (PID=2897) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:16:26.485+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:16:26.488+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:26.488+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:16:26.513+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:26.512+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:16:26.513+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:26.513+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:16:26.515+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:26.515+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:16:26.991+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:26.990+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:16:27.163+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:27.157+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:16:27.163+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:16:27.172+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.694 seconds
[2025-01-29T15:16:57.780+0000] {processor.py:186} INFO - Started process (PID=2963) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:16:57.780+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:16:57.783+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:57.782+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:16:57.804+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:57.803+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:16:57.804+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:57.804+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:16:57.806+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:57.806+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:16:58.547+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:58.546+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:16:58.793+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:16:58.786+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:16:58.794+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:16:58.804+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 1.029 seconds
[2025-01-29T15:17:28.982+0000] {processor.py:186} INFO - Started process (PID=3029) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:17:28.983+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:17:28.985+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:17:28.985+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:17:29.005+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:17:29.005+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:17:29.006+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:17:29.005+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:17:29.007+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:17:29.007+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:17:29.521+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:17:29.521+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:17:29.693+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:17:29.688+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:17:29.694+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:17:29.704+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.728 seconds
[2025-01-29T15:18:00.265+0000] {processor.py:186} INFO - Started process (PID=3095) to work on /opt/airflow/dags/churn.py
[2025-01-29T15:18:00.266+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/churn.py for tasks to queue
[2025-01-29T15:18:00.268+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:18:00.268+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/churn.py
[2025-01-29T15:18:00.290+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:18:00.290+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:18:00.291+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:18:00.290+0000] {sql.py:186} WARNING - This setter is for backward compatibility and should not be used.
Since the introduction of connection property, the providers listed below breaks due to assigning value to self.connection in their __init__ method.
* apache-airflow-providers-mysql<5.7.1
* apache-airflow-providers-elasticsearch<5.5.1
* apache-airflow-providers-postgres<5.13.0
[2025-01-29T15:18:00.293+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:18:00.292+0000] {base.py:84} INFO - Retrieving connection 'destination_db'
[2025-01-29T15:18:00.864+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:18:00.864+0000] {churn.py:58} INFO - Создание таблицы users_churn.
[2025-01-29T15:18:01.073+0000] {logging_mixin.py:190} INFO - [2025-01-29T15:18:01.067+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/churn.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DuplicateTable: relation "unique_customer_constraint" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/airflow/dags/churn.py", line 124, in <module>
    prepare_churn_dataset()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/dag.py", line 4307, in factory
    f(**f_kwargs)
  File "/opt/airflow/dags/churn.py", line 115, in prepare_churn_dataset
    create_table()  # Вызов функции для создания таблицы
  File "/opt/airflow/dags/churn.py", line 59, in create_table
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DuplicateTable) relation "unique_customer_constraint" already exists

[SQL: 
CREATE TABLE users_churn (
	id SERIAL NOT NULL, 
	customer_id VARCHAR NOT NULL, 
	begin_date TIMESTAMP WITHOUT TIME ZONE, 
	end_date TIMESTAMP WITHOUT TIME ZONE, 
	type VARCHAR, 
	paperless_billing VARCHAR, 
	payment_method VARCHAR, 
	monthly_charges FLOAT, 
	total_charges FLOAT, 
	internet_service VARCHAR, 
	online_security VARCHAR, 
	online_backup VARCHAR, 
	device_protection VARCHAR, 
	tech_support VARCHAR, 
	streaming_tv VARCHAR, 
	streaming_movies VARCHAR, 
	gender VARCHAR, 
	senior_citizen INTEGER, 
	partner VARCHAR, 
	dependents VARCHAR, 
	multiple_lines VARCHAR, 
	target INTEGER, 
	PRIMARY KEY (id), 
	CONSTRAINT unique_customer_constraint UNIQUE (customer_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-01-29T15:18:01.074+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/churn.py
[2025-01-29T15:18:01.089+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/churn.py took 0.829 seconds
